1️⃣ Parsujesz surowy HTTP
Z tego:
POST /upload HTTP/1.1
Host: localhost:8080
Content-Length: 123
Content-Type: multipart/form-data

Robisz:
HttpRequest {
    method = POST
    path = /upload
    version = HTTP/1.1
    headers["Content-Length"] = "123"
    body = ...
}

2️⃣ Weryfikujesz poprawność protokołu
Ty decydujesz:
czy metoda jest znana
czy HTTP/1.1
czy nagłówki są poprawne
czy body nie jest za duże
czy chunked jest poprawnie zdekodowane
Jeśli coś jest złe → odpowiedź HTTP z błędem (400, 413, 411, itd.)

3️⃣ Budujesz odpowiedź HTTP (nie treść!)
To kluczowe:
Ty nie tworzysz HTML-a, ale:
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 123
<body>...</body>

Alina da Ci:
kod statusu
body (string lub plik)
Ty robisz z tego poprawny HTTP.

4. Jak wygląda poprawny przepływ między Wami
Client (browser)
   ↓
[Kacper]
   - socket
   - poll
   - recv()
   ↓
[Kinga – TY]
   - parse HTTP
   - validate HTTP
   - HttpRequest
   ↓
[Alina]
   - routing
   - filesystem
   - CGI
   ↓
[Kinga – TY]
   - HttpResponse
   - headers + status
   ↓
[Kacper]
   - send()

Ty jesteś mózgiem protokołu HTTP.
Bez Ciebie:
przeglądarka nie zrozumie serwera

5. Jedno zdanie, które MUSISZ umieć powiedzieć na evaluacji
„Moja część odpowiada za pełną obsługę protokołu HTTP: parsowanie żądań, walidację zgodności z HTTP/1.1 oraz generowanie poprawnych odpowiedzi,
 które następnie są wysyłane przez warstwę sieciową.”

 1. Co naprawdę robi Twój serwer?
Ktoś w przeglądarce wpisuje:
http://localhost:8080
Przeglądarka nie wysyła „chcę stronę”, tylko wysyła tekst, np.:

GET / HTTP/1.1
Host: localhost:8080
User-Agent: Chrome
To jest zwykły tekst.

2. Co robi Kacper (nie Ty)
Kacper:
odbiera ten tekst z internetu
NIE rozumie, co on znaczy
przekazuje go Tobie jako string

Czyli do Ciebie trafia:
"GET / HTTP/1.1\r\nHost: localhost:8080\r\n\r\n"

3. Co robisz TY (najważniejsze)
Twoja praca to zrozumieć ten tekst.

Przykład 1 — GET
Dostajesz:
GET /about HTTP/1.1
Host: localhost

Ty mówisz:
Aha.

metoda: GET
ścieżka: /about
wersja: HTTP/1.1

I zapisujesz to w „pudełku” (obiekcie):
HttpRequest
- method = GET
- path = /about
- headers = Host: localhost
I to pudełko dajesz Alinie.

Przykład 2 — POST (formularz)

Przeglądarka wysyła:
POST /upload HTTP/1.1
Host: localhost
Content-Length: 11

hello world

Ty:
rozumiesz, że to POST
wiesz, że hello world to dane od użytkownika
zapisujesz to w HttpRequest
pilnujesz, czy dane nie są za duże
Jeśli za duże → od razu błąd, Alina tego nie widzi.

4. Co robi Alina (nie Ty)
Alina patrzy na:
method = POST
path = /upload
body = "hello world"

I decyduje:
gdzie zapisać plik
czy wolno
czy uruchomić CGI
czy to przekierować

I mówi do Ciebie np.:
OK, odpowiedz 201, tu jest treść odpowiedzi

5. Co znowu robisz TY
Alina nie pisze odpowiedzi HTTP.
Ona daje Ci:
status: 200
treść strony
Ty robisz z tego ładną odpowiedź dla przeglądarki:

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 20

<html>...</html>
I to wraca do Kacpra, który wysyła to do przeglądarki.

6. Bardzo ważne: kiedy Ty mówisz „NIE”
Jeśli klient wyśle coś głupiego:
GOT / HTTP/9.0

Ty mówisz:

To nie jest poprawne HTTP
→ 400 Bad Request
Alina w ogóle tego nie widzi.

7. Najkrócej jak się da (1 zdanie)
Twoja rola:
Zamieniasz tekst od przeglądarki na zrozumiałe dane dla serwera i z powrotem na poprawny tekst dla przeglądarki.

8. Prosta mapa w głowie
Tekst z internetu
        ↓
     TY (rozumiesz)
        ↓
     Alina (decyduje)
        ↓
     TY (odpowiadasz)
        ↓
   Tekst do internetu

KROK 1 — Dostajesz tekst

Dostajesz od Kacpra coś takiego:
GET /hello HTTP/1.1\r\n
Host: localhost\r\n
User-Agent: Chrome\r\n
\r\n

KROK 2 — Sprawdzasz: gdzie kończą się nagłówki

W HTTP:
nagłówki kończą się w miejscu:
pusta linia → \r\n\r\n
Ty:
szukasz \r\n\r\n
wszystko przed → nagłówki
wszystko po → body
Jeśli nie ma \r\n\r\n → request niekompletny (czekasz lub błąd)

KROK 3 — Pierwsza linia (najważniejsza)

Pierwsza linia to zawsze:

METODA ŚCIEŻKA WERSJA
Przykład:
GET /hello HTTP/1.1
Ty:
dzielisz po spacji

sprawdzasz:
czy są 3 części
czy metoda to GET / POST / DELETE
czy wersja to HTTP/1.1
Jeśli nie → 400 Bad Request

KROK 4 — Reszta nagłówków (linijka po linijce)
Każda linia wygląda tak:
Klucz: wartość
Przykład:
Host: localhost
Content-Length: 11

Ty:
bierzesz każdą linię
dzielisz po :
zapisujesz do mapy:

headers["Host"] = "localhost"
Jeśli linia nie ma : → błąd

KROK 5 — Sprawdzasz Host (ważne)

HTTP/1.1 musi mieć:
Host: coś
Jeśli nie ma → 400 Bad Request

KROK 6 — Body (jeśli jest)
Jeśli to GET
body nie obchodzi Cię
Jeśli POST

Sprawdzasz:
czy jest Content-Length
czy body ma dokładnie tyle znaków

Przykład:
Content-Length: 5
hello
Jeśli body za krótkie / za długie → błąd

KROK 7 — Chunked (jeśli jest)
Jeśli widzisz:
Transfer-Encoding: chunked
To:
body wygląda dziwnie:
5
hello
0
Ty:
składasz to w jedno:
hello
I dopiero to zapisujesz jako body.

KROK 8 — Składasz wszystko do jednego pudełka

Na koniec masz:
HttpRequest:
- method = GET
- path = /hello
- headers = {...}
- body = ""
- is_valid = true
To pudełko dajesz Alinie.

KROK 9 — Jeśli coś nie gra
Jeśli w którymkolwiek kroku:
coś jest źle
czegoś brakuje
format się nie zgadza
→ przerywasz
→ tworzysz odpowiedź:
400 Bad Request

JEDNO ZDANIE DO ZAPAMIĘTANIA
Parser HTTP to dzielenie tekstu na kawałki i sprawdzanie, czy te kawałki mają sens.

TWOJA MINI CHECKLISTA PARSERA
✔ znaleźć \r\n\r\n
✔ przeczytać pierwszą linię
✔ sprawdzić metodę
✔ sprawdzić wersję
✔ wczytać nagłówki
✔ sprawdzić Host
✔ ogarnąć body
✔ złożyć HttpRequest

ZASADA 1 — MUSI BYĆ STRUKTURA
Każdy request HTTP zawsze wygląda tak:
LINIA 1  ← najważniejsza
LINIA 2
LINIA 3
...
PUSTA LINIA
BODY (czasem)

Dobry:
GET / HTTP/1.1
Host: localhost

Zły (brak pustej linii):
GET / HTTP/1.1
Host: localhost
➡ zły, bo nie wiadomo, gdzie kończą się nagłówki.

ZASADA 2 — PIERWSZA LINIA MA ZAWSZE 3 CZĘŚCI
METODA  ŚCIEŻKA  WERSJA
Dobry:
GET /hello HTTP/1.1

Zły:
GET /hello
➡ zły, bo brakuje wersji.

ZASADA 3 — METODA MUSI BYĆ ZNANA
Serwer nie zgaduje.

Dobre metody:
GET
POST
DELETE

Złe:
FETCH
SEND
HELLO
➡ zły request.

ZASADA 4 — HTTP/1.1 WYMAGA Host
To bardzo ważne.

Dobry:
Host: localhost

Zły:
(brak Host)
➡ zły, nawet jeśli reszta wygląda OK.

ZASADA 5 — NAGŁÓWKI MUSZĄ MIEĆ FORMAT klucz: wartość
Dobry:
Content-Length: 10

Zły:
Content-Length 10
➡ brak : → zły request.

ZASADA 6 — BODY MUSI PASOWAĆ DO NAGŁÓWKÓW
Jeśli klient mówi:
Content-Length: 5
To body musi mieć dokładnie 5 znaków.

Dobry:
hello

Zły:
hello world
➡ kłamstwo → zły request.

ZASADA 7 — NIE WSZYSTKIE REQUESTY MAJĄ BODY
GET → zwykle bez body
POST → z body
DELETE → różnie

Jeśli ktoś wysyła:
GET / HTTP/1.1
hello
➡ podejrzane → najczęściej błąd.